<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <title>To Bingbing</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <style type="text/css">
    #source {
      display: none;
    }
  </style>
  <link href="style/default.css" type="text/css" rel="stylesheet">
  <script type="text/javascript" src="style/jquery.js"></script>

</head>

<body>
  <audio autoplay="autoplay" loop>
    <source src="walktoyou.mp3" type="audio/mp3" />
    <source src="walktoyou.ogg" type="audio/ogg" />
    <embed height="100" width="100" src="walktoyou.mp3" />
  </audio>
  <div id="mainDiv">
    <div id="title">
      <p id="title-content">在遇到你之前，我以为是I won't 。和你相处之后，我觉得是it's possible.</p>
    </div>
    <div id="source">
      <ul>
        <li>
          <sapn class="keycode" style="font-size: 18px;">2020/10/18</sapn> <br><br>
          <span class="text">快乐有很多种，遇见你是第一种~~~</span> <br>
          <span class="text">生日快乐~~~</span> <br>
        </li>
        <br><br>
        <li>
          <sapn class="keycode" style="font-size: 18px;">2020/10/19</sapn> <br><br>
          <span class="text">或许我真的喜欢上你了呢，你知道吗?</span> <br>
          <span class="text">但是我明白看人还是要久一点</span> <br>
          <span class="text">尽管我现在挺喜欢<span class="keycode3">你身上的特质</span>的</span> <br>
          <span class="text">也想保护你的<span class="keycode3">童心</span>~~~</span> <br>
        </li>
        <br><br>
        <li>
          <sapn class="keycode" style="font-size: 18px;">2020/10/20</sapn> <br><br>
          <span class="text">今天和你一起学习</span> <br>
          <span class="text">是我一天中最快乐的时光</span> <br>
        </li>
        <br><br>
        <li>
          <sapn class="keycode" style="font-size: 18px;">2020/10/21</sapn> <br><br>
          <span class="text">忙与你几乎白天满课</span> <br>
          <span class="text">体测与你出校门的欢乐...^_^</span> <br>
        </li>
        <br><br>
        <li>
          <sapn class="keycode" style="font-size: 18px;">2020/10/22</sapn> <br><br>
          <span class="text">下了本书给你,希望你喜欢</span> <br>
          <span class="text">想让你早点感受一下深度学习的魅力</span> <br>
          <span class="text">毕竟这个时代，无论哪个方向，都会经常涉及AI了</span> <br>
        </li>
        <br><br>
        <li>
          <span class="keycode" style="font-size: 18px;">2020/10/27</span> <br><br>
          <span class="text">今天是世界恋爱日 ^_^</span> <br>
          <span class="text">有点想要<span class="keycode3">保护你</span>咦~~~</span> <br>
          <span class="text">晚安~~~ 23:55</span> <br>
        </li>
        <br><br>

        <br><br>
        <li>
          <span class="keycode" style="font-size: 18px;">2020/10/31</span> <br><br>
          <span class="text">这两天应该会向你<span class="keycode3">表白</span></span> <br>
          <span class="text">不知道你会不会答应咦</span> <br>
          <span class="text">还是想试一试哩</span> <br>
          <span class="text">有你的日子里，我总会感到很开心</span> <br>
          <span class="text">我想保护你，和你一起成长</span> <br>
          <span class="text">你知道深度学习的数学 Deep Learning Mathmatics的字母 <span>DLM</span>的意思吗?</span> <br>
          <span class="text">那就是 <span class="keycode3">Deeply Like Minbing.</span></span> <br>
          <img src="./asset/imgs/love.jpeg" class="img-love"/>

        </li>  

        <!-- 继续你的日常记录 start this...-->
       
        <br><br>
        <li>
          <span class="text">未完待续...</span> <br>
        </li>
      </ul>


    </div>

    <div id="output">

    </div>

    <div id="space"></div>
  </div>


  <script type="text/javascript">
    class Typing {
      constructor(opts) {
        this.opts = opts || {};
        this.source = opts.source;
        this.output = opts.output;
        this.delay = opts.delay || 120;
        this.chain = {
          parent: null,
          dom: this.output,
          val: []
        };
        if (!(typeof this.opts.done === 'function')) this.opts.done = function () {
        };
      }

      init() {
        //初始化函数
        this.chain.val = this.convert(this.source, this.chain.val);
      }

      convert(dom, arr) {
        //将dom节点的子节点转换成数组，
        let children = Array.from(dom.childNodes)
        for (let i = 0; i < children.length; i++) {
          let node = children[i]
          if (node.nodeType === 3) {
            arr = arr.concat(node.nodeValue.split(''))   //将字符串转换成字符串数组，后面打印时才会一个一个的打印
          } else if (node.nodeType === 1) {
            let val = []
            val = this.convert(node, val)
            arr.push({
              'dom': node,
              'val': val
            })
          }
        }
        return arr
      }

      print(dom, val, callback) {
        setTimeout(function () {
          dom.appendChild(document.createTextNode(val));
          callback();
        }, this.delay);
      }

      play(ele) {
        //当打印最后一个字符时，动画完毕，执行done
        if (!ele.val.length) {
          if (ele.parent) this.play(ele.parent);
          else this.opts.done();
          return;
        }
        let current = ele.val.shift()  //获取第一个元素，同时删除数组中的第一个元素
        if (typeof current === 'string') {
          this.print(ele.dom, current, () => {
            this.play(ele); //继续打印下一个字符
          })
        } else {
          let dom = current.dom.cloneNode() //克隆节点，不克隆节点的子节点，所以不用加参数true
          ele.dom.appendChild(dom)
          this.play({
            parent: ele,
            dom,
            val: current.val
          })
        }
      }

      start() {
        this.init();
        this.play(this.chain);
      }
    }
  </script>
  <script type="text/javascript">
    let source = document.getElementById('source')
    let output = document.getElementById('output')
    let typing = new Typing({
      source,
      output
    })
    typing.start()
  </script>
</body>

</html>